<?xml version="1.0" encoding="UTF-8"?>
<!--
	Copyright (c) 2001-2002.
	
	Centre for Research on Inner City Health, St. Michael's Hospital, Toronto. All Rights Reserved.
	This software is published under the GPL GNU General Public License.
	This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.
	This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
	See the GNU General Public License for more details.
	You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
	
	OSCAR TEAM
	
	This software was written for Centre for Research on Inner City Health, St. Michael's Hospital, Toronto, Ontario, Canada
-->
<!DOCTYPE hibernate-mapping PUBLIC
	"-//Hibernate/Hibernate Mapping DTD//EN"
	"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd" >
<hibernate-mapping package="org.oscarehr.PMmodule.model">
	<class name="Demographic" table="demographic">
		<id column="demographic_no" name="DemographicNo" type="integer" unsaved-value="0">
			<generator class="native" />
		</id>
		<property column="first_name" length="30" name="FirstName" not-null="true" type="string" />
		<property column="last_name" length="30" name="LastName" not-null="true" type="string" />
		<property column="sex" length="1" name="Sex" not-null="true" type="string" />
		<property name="sexDesc" not-null="true" type="string" formula="(select lst.description from lst_gender lst where lst.code=sex)"/>
		<property column="dob" name="DateOfBirth" type="calendar" />
		<property column="address" length="60" name="Address" type="string" />
		<property column="city" length="20" name="City" type="string" />
		<property column="province" length="20" name="Province" type="string" />
		<property column="postal" length="9" name="Postal" type="string" />
		<property column="email" length="100" name="Email" type="string" />
		<property column="phone" length="20" name="Phone" type="string" />
		<property column="phone2" length="20" name="Phone2" type="string" />
		<property column="pin" length="10" name="Pin" type="string" />
		
		<property column="hin" length="20" name="Hin" type="string" />
		<property column="ver" length="3" name="Ver" type="string" />
		<property column="hc_type" length="20" name="HcType" type="string" />
		<property column="hc_renew_date" length="10" name="HcRenewDate" type="date" />
		
		<property column="roster_status" length="20" name="RosterStatus" type="string" />
		<property column="patient_status" length="20" name="PatientStatus" type="string" />
		<property column="date_joined" length="10" name="DateJoined" type="date" />
		<property column="chart_no" length="10" name="ChartNo" type="string" />
		<property column="provider_no" length="250" name="ProviderNo" type="string" />
		<property column="end_date" length="10" name="EndDate" type="date" />
		<property column="eff_date" length="10" name="EffDate" type="date" />
		<property column="pcn_indicator" length="20" name="PcnIndicator" type="string" />
		<property column="family_doctor" length="80" name="FamilyDoctor" type="string" />
		<property name="lastUpdateDate" column="lastupdatedate"></property>
		<property column="alias" length="70" name="Alias" type="string" />
		<property column="previousAddress" length="255" name="PreviousAddress" type="string" />
		<property column="children" length="255" name="Children" type="string" />
		<property column="sourceOfIncome" length="255" name="SourceOfIncome" type="string" />
		<property column="citizenship" length="40" name="Citizenship" type="string" />
		<property column="sin" length="15" name="Sin" type="string" />
		<property name="merged" column="ismerged" type="boolean"></property>
        <property name="HeadRecord" type="integer"
                  formula="(select min(d.merged_to) from demographic_merged d where d.deleted = 0 and d.demographic_no = demographic_no)"/>

		<property name="activeCount" type="integer"
				  formula="(select count(*) from admission a where a.client_id=demographic_no and a.admission_status='admitted')" /> 
				          <!-- and a.program_id in (select p.program_id from program p where p.type='Bed'))" / -->
		<property name="hsAlertCount"
				  formula="(select count(*) from health_safety h where h.demographic_no=demographic_no)" />
               
                <set name="SubRecord" table="demographic_merged" where= "deleted = 0" lazy="false" >
                    <key column="merged_to"/>
                    <element column="demographic_no" type="integer"/>
                </set>
        <property column="benefit_unit_status" length="7" name="benefitUnitStatus" type="string" />                
	</class>
</hibernate-mapping>
